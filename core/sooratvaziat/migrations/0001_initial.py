# Generated by Django 5.2.7 on 2025-11-20 14:20

import django.core.validators
import django.db.models.deletion
import simple_history.models
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('fehrestbaha', '0001_initial'),
        ('project', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='DetailedFinancialReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
            ],
        ),
        migrations.CreateModel(
            name='DetailedMeasurement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_quantity', models.DecimalField(decimal_places=2, default=0, help_text='مجموع مقادیر از تمام صورت\u200cجلسات برای این آیتم', max_digits=15, verbose_name='مجموع مقدار کل')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='مجموع مبالغ از تمام صورت\u200cجلسات برای این آیتم', max_digits=18, verbose_name='مجموع مبلغ کل')),
                ('sessions_count', models.PositiveIntegerField(default=0, help_text='تعداد صورت\u200cجلساتی که این آیتم در آن استفاده شده', verbose_name='تعداد صورت\u200cجلسات')),
                ('items_count', models.PositiveIntegerField(default=0, help_text='تعداد کل ردیف\u200cهای مرتبط با این آیتم', verbose_name='تعداد ردیف\u200cها')),
                ('projects_count', models.PositiveIntegerField(default=0, help_text='تعداد پروژه\u200cهای مختلف', verbose_name='تعداد پروژه\u200cها')),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, help_text='قیمت واحد از فهرست بها', max_digits=12, verbose_name='قیمت واحد')),
                ('last_updated', models.DateTimeField(auto_now=True, verbose_name='آخرین به\u200cروزرسانی')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('price_list_item', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='detailed_measurement', to='fehrestbaha.pricelistitem', verbose_name='آیتم فهرست بها')),
            ],
            options={
                'verbose_name': 'ریز متره کل',
                'verbose_name_plural': 'ریز متره\u200cهای کل',
                'ordering': ['price_list_item__row_number'],
            },
        ),
        migrations.CreateModel(
            name='HistoricalDetailedMeasurement',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('total_quantity', models.DecimalField(decimal_places=2, default=0, help_text='مجموع مقادیر از تمام صورت\u200cجلسات برای این آیتم', max_digits=15, verbose_name='مجموع مقدار کل')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='مجموع مبالغ از تمام صورت\u200cجلسات برای این آیتم', max_digits=18, verbose_name='مجموع مبلغ کل')),
                ('sessions_count', models.PositiveIntegerField(default=0, help_text='تعداد صورت\u200cجلساتی که این آیتم در آن استفاده شده', verbose_name='تعداد صورت\u200cجلسات')),
                ('items_count', models.PositiveIntegerField(default=0, help_text='تعداد کل ردیف\u200cهای مرتبط با این آیتم', verbose_name='تعداد ردیف\u200cها')),
                ('projects_count', models.PositiveIntegerField(default=0, help_text='تعداد پروژه\u200cهای مختلف', verbose_name='تعداد پروژه\u200cها')),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, help_text='قیمت واحد از فهرست بها', max_digits=12, verbose_name='قیمت واحد')),
                ('last_updated', models.DateTimeField(blank=True, editable=False, verbose_name='آخرین به\u200cروزرسانی')),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('price_list_item', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='fehrestbaha.pricelistitem', verbose_name='آیتم فهرست بها')),
            ],
            options={
                'verbose_name': 'historical ریز متره کل',
                'verbose_name_plural': 'historical ریز متره\u200cهای کل',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalMeasurementSession',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('session_number', models.CharField(blank=True, help_text='شماره صورت\u200cجلسه (خودکار تولید می\u200cشود اگر خالی باشد)', max_length=50, null=True)),
                ('session_date', models.DateField(blank=True, help_text='تاریخ برگزاری صورت\u200cجلسه', null=True, verbose_name='تاریخ صورت\u200cجلسه')),
                ('discipline_choice', models.CharField(choices=[('AB', 'ابنیه'), ('ME', 'مکانیک'), ('EL', 'برق'), ('OT', 'سایر')], default='01', help_text='نوع فهرست بها (ابنیه، مکانیک، برق، ...)', max_length=2, verbose_name='رشته فعالیت')),
                ('description', models.TextField(blank=True, help_text='توضیحات اضافی صورت\u200cجلسه', null=True, verbose_name='توضیحات')),
                ('notes', models.TextField(blank=True, default='', help_text='یادداشت\u200cهای داخلی', null=True, verbose_name='یادداشت\u200cها')),
                ('items_count', models.PositiveIntegerField(default=0, help_text='تعداد کل آیتم\u200cهای این صورت\u200cجلسه', verbose_name='تعداد آیتم\u200cها')),
                ('status', models.CharField(choices=[('draft', 'پیش\u200cنویس'), ('submitted', 'ارسال\u200cشده'), ('approved', 'تایید\u200cشده'), ('rejected', 'رد\u200cشده')], default='submitted', max_length=20, verbose_name='وضعیت')),
                ('is_active', models.BooleanField(default=True, help_text='برای حذف نرم استفاده می\u200cشود', verbose_name='فعال/غیرفعال')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='زمان ایجاد')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='زمان آخرین ویرایش')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='ایجادکننده')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('modified_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='ویرایش\u200cکننده')),
                ('project', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='project.project', verbose_name='پروژه مرتبط')),
            ],
            options={
                'verbose_name': 'historical measurement session',
                'verbose_name_plural': 'historical measurement sessions',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalProjectFinancialSummary',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('total_quantity', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مقادیر تمام صورت\u200cجلسات', max_digits=15, verbose_name='مجموع کل مقدار')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مبالغ تمام صورت\u200cجلسات', max_digits=18, verbose_name='مجموع کل مبلغ')),
                ('total_with_vat', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل + مالیات', max_digits=18, verbose_name='مجموع کل با مالیات')),
                ('total_quantity_abnieh', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='مجموع ابنیه')),
                ('total_amount_abnieh', models.DecimalField(decimal_places=2, default=0, max_digits=18, verbose_name='مبلغ ابنیه')),
                ('total_quantity_mekanik', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='مجموع مکانیک')),
                ('total_amount_mekanik', models.DecimalField(decimal_places=2, default=0, max_digits=18, verbose_name='مبلغ مکانیک')),
                ('total_quantity_bargh', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='مجموع برق')),
                ('total_amount_bargh', models.DecimalField(decimal_places=2, default=0, max_digits=18, verbose_name='مبلغ برق')),
                ('sessions_count', models.PositiveIntegerField(default=0, verbose_name='تعداد صورت\u200cجلسات')),
                ('approved_sessions_count', models.PositiveIntegerField(default=0, verbose_name='تعداد صورت\u200cجلسات تایید شده')),
                ('total_items_count', models.PositiveIntegerField(default=0, verbose_name='تعداد کل آیتم\u200cها')),
                ('unique_pricelist_items_count', models.PositiveIntegerField(default=0, verbose_name='تعداد آیتم\u200cهای منحصر به فرد فهرست بها')),
                ('progress_percentage', models.DecimalField(decimal_places=2, default=0, help_text='بر اساس نسبت مبلغ متره به مبلغ قرارداد', max_digits=5, verbose_name='درصد پیشرفت')),
                ('vat_rate', models.DecimalField(decimal_places=2, default=9.0, max_digits=5, verbose_name='نرخ مالیات')),
                ('last_updated', models.DateTimeField(blank=True, editable=False)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('project', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='project.project', verbose_name='پروژه مرتبط')),
            ],
            options={
                'verbose_name': 'historical خلاصه مالی پروژه',
                'verbose_name_plural': 'historical خلاصه\u200cهای مالی پروژه\u200cها',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='MeasurementSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_number', models.CharField(blank=True, help_text='شماره صورت\u200cجلسه (خودکار تولید می\u200cشود اگر خالی باشد)', max_length=50, null=True)),
                ('session_date', models.DateField(blank=True, help_text='تاریخ برگزاری صورت\u200cجلسه', null=True, verbose_name='تاریخ صورت\u200cجلسه')),
                ('discipline_choice', models.CharField(choices=[('AB', 'ابنیه'), ('ME', 'مکانیک'), ('EL', 'برق'), ('OT', 'سایر')], default='01', help_text='نوع فهرست بها (ابنیه، مکانیک، برق، ...)', max_length=2, verbose_name='رشته فعالیت')),
                ('description', models.TextField(blank=True, help_text='توضیحات اضافی صورت\u200cجلسه', null=True, verbose_name='توضیحات')),
                ('notes', models.TextField(blank=True, default='', help_text='یادداشت\u200cهای داخلی', null=True, verbose_name='یادداشت\u200cها')),
                ('items_count', models.PositiveIntegerField(default=0, help_text='تعداد کل آیتم\u200cهای این صورت\u200cجلسه', verbose_name='تعداد آیتم\u200cها')),
                ('status', models.CharField(choices=[('draft', 'پیش\u200cنویس'), ('submitted', 'ارسال\u200cشده'), ('approved', 'تایید\u200cشده'), ('rejected', 'رد\u200cشده')], default='submitted', max_length=20, verbose_name='وضعیت')),
                ('is_active', models.BooleanField(default=True, help_text='برای حذف نرم استفاده می\u200cشود', verbose_name='فعال/غیرفعال')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='زمان ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='زمان آخرین ویرایش')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_sessions', to=settings.AUTH_USER_MODEL, verbose_name='ایجادکننده')),
                ('modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modified_sessions', to=settings.AUTH_USER_MODEL, verbose_name='ویرایش\u200cکننده')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='measurement_sessions', to='project.project', verbose_name='پروژه مرتبط')),
            ],
        ),
        migrations.CreateModel(
            name='HistoricalMeasurementSessionItem',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('row_description', models.CharField(help_text="توضیح خاص این متره (مثل 'دیوار غربی - طبقه ۱')", max_length=255, verbose_name='شرح ردیف')),
                ('length', models.DecimalField(blank=True, decimal_places=2, help_text='طول در متر', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='طول (متر)')),
                ('width', models.DecimalField(blank=True, decimal_places=2, help_text='عرض در متر', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='عرض (متر)')),
                ('height', models.DecimalField(blank=True, decimal_places=2, help_text='ارتفاع در متر', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='ارتفاع (متر)')),
                ('weight', models.DecimalField(blank=True, decimal_places=2, help_text='وزن کل در کیلوگرم', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='وزن (کیلوگرم)')),
                ('count', models.DecimalField(decimal_places=2, default=1, help_text='تعداد تکرار', max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='تعداد')),
                ('quantity', models.DecimalField(decimal_places=2, default=0, help_text='مقدار محاسبه\u200cشده بر اساس واحد', max_digits=15, verbose_name='مقدار کل')),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, help_text='قیمت واحد از فهرست بها', max_digits=12, verbose_name='قیمت واحد')),
                ('item_total', models.DecimalField(decimal_places=2, default=0, help_text='مقدار × قیمت واحد', max_digits=15, verbose_name='مبلغ کل ردیف')),
                ('notes', models.TextField(blank=True, help_text='یادداشت\u200cهای خاص این ردیف', null=True, verbose_name='یادداشت ردیف')),
                ('is_active', models.BooleanField(default=True, verbose_name='فعال/غیرفعال')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='زمان ایجاد')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='زمان آخرین ویرایش')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='ایجادکننده')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('modified_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='ویرایش\u200cکننده')),
                ('pricelist_item', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='fehrestbaha.pricelistitem', verbose_name='آیتم فهرست بها')),
                ('measurement_session_number', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='sooratvaziat.measurementsession', verbose_name='صورت\u200cجلسه')),
            ],
            options={
                'verbose_name': 'historical آیتم صورت\u200cجلسه',
                'verbose_name_plural': 'historical آیتم\u200cهای صورت\u200cجلسه',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalFinancialStatus',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('total_quantity', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مقادیر تمام آیتم\u200cهای صورت\u200cجلسه', max_digits=15, verbose_name='مجموع مقدار')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مبالغ تمام آیتم\u200cهای صورت\u200cجلسه', max_digits=18, verbose_name='مجموع مبلغ')),
                ('active_items_count', models.PositiveIntegerField(default=0, help_text='تعداد کل آیتم\u200cهای فعال', verbose_name='تعداد آیتم\u200cهای فعال')),
                ('unique_pricelist_items_count', models.PositiveIntegerField(default=0, help_text='تعداد آیتم\u200cهای مختلف فهرست بها', verbose_name='تعداد آیتم\u200cهای منحصر به فرد فهرست بها')),
                ('row_descriptions_count', models.PositiveIntegerField(default=0, help_text='تعداد توضیحات مختلف (row_description)', verbose_name='تعداد ردیف\u200cهای توصیفی')),
                ('vat_rate', models.DecimalField(decimal_places=2, default=9.0, help_text='نرخ VAT', max_digits=5, verbose_name='نرخ مالیات')),
                ('total_with_vat', models.DecimalField(decimal_places=2, default=0, help_text='مجموع مبلغ + مالیات', max_digits=18, verbose_name='مجموع با مالیات')),
                ('is_approved', models.BooleanField(default=False, help_text='وضعیت تایید صورت\u200cجلسه', verbose_name='تایید شده')),
                ('approval_date', models.DateField(blank=True, null=True, verbose_name='تاریخ تایید')),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('last_calculated_at', models.DateTimeField(blank=True, editable=False, verbose_name='آخرین محاسبه')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('approved_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='تاییدکننده')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('measurement_session', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='sooratvaziat.measurementsession', verbose_name='صورت\u200cجلسه مرتبط')),
            ],
            options={
                'verbose_name': 'historical صورت وضعیت مالی',
                'verbose_name_plural': 'historical صورت\u200cهای وضعیت مالی',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='FinancialStatus',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_quantity', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مقادیر تمام آیتم\u200cهای صورت\u200cجلسه', max_digits=15, verbose_name='مجموع مقدار')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مبالغ تمام آیتم\u200cهای صورت\u200cجلسه', max_digits=18, verbose_name='مجموع مبلغ')),
                ('active_items_count', models.PositiveIntegerField(default=0, help_text='تعداد کل آیتم\u200cهای فعال', verbose_name='تعداد آیتم\u200cهای فعال')),
                ('unique_pricelist_items_count', models.PositiveIntegerField(default=0, help_text='تعداد آیتم\u200cهای مختلف فهرست بها', verbose_name='تعداد آیتم\u200cهای منحصر به فرد فهرست بها')),
                ('row_descriptions_count', models.PositiveIntegerField(default=0, help_text='تعداد توضیحات مختلف (row_description)', verbose_name='تعداد ردیف\u200cهای توصیفی')),
                ('vat_rate', models.DecimalField(decimal_places=2, default=9.0, help_text='نرخ VAT', max_digits=5, verbose_name='نرخ مالیات')),
                ('total_with_vat', models.DecimalField(decimal_places=2, default=0, help_text='مجموع مبلغ + مالیات', max_digits=18, verbose_name='مجموع با مالیات')),
                ('is_approved', models.BooleanField(default=False, help_text='وضعیت تایید صورت\u200cجلسه', verbose_name='تایید شده')),
                ('approval_date', models.DateField(blank=True, null=True, verbose_name='تاریخ تایید')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_calculated_at', models.DateTimeField(auto_now=True, verbose_name='آخرین محاسبه')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_statuses', to=settings.AUTH_USER_MODEL, verbose_name='تاییدکننده')),
                ('measurement_session', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='financial_status', to='sooratvaziat.measurementsession', verbose_name='صورت\u200cجلسه مرتبط')),
            ],
            options={
                'verbose_name': 'صورت وضعیت مالی',
                'verbose_name_plural': 'صورت\u200cهای وضعیت مالی',
                'ordering': ['-measurement_session__created_at'],
            },
        ),
        migrations.CreateModel(
            name='ProjectFinancialSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_quantity', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مقادیر تمام صورت\u200cجلسات', max_digits=15, verbose_name='مجموع کل مقدار')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل مبالغ تمام صورت\u200cجلسات', max_digits=18, verbose_name='مجموع کل مبلغ')),
                ('total_with_vat', models.DecimalField(decimal_places=2, default=0, help_text='مجموع کل + مالیات', max_digits=18, verbose_name='مجموع کل با مالیات')),
                ('total_quantity_abnieh', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='مجموع ابنیه')),
                ('total_amount_abnieh', models.DecimalField(decimal_places=2, default=0, max_digits=18, verbose_name='مبلغ ابنیه')),
                ('total_quantity_mekanik', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='مجموع مکانیک')),
                ('total_amount_mekanik', models.DecimalField(decimal_places=2, default=0, max_digits=18, verbose_name='مبلغ مکانیک')),
                ('total_quantity_bargh', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='مجموع برق')),
                ('total_amount_bargh', models.DecimalField(decimal_places=2, default=0, max_digits=18, verbose_name='مبلغ برق')),
                ('sessions_count', models.PositiveIntegerField(default=0, verbose_name='تعداد صورت\u200cجلسات')),
                ('approved_sessions_count', models.PositiveIntegerField(default=0, verbose_name='تعداد صورت\u200cجلسات تایید شده')),
                ('total_items_count', models.PositiveIntegerField(default=0, verbose_name='تعداد کل آیتم\u200cها')),
                ('unique_pricelist_items_count', models.PositiveIntegerField(default=0, verbose_name='تعداد آیتم\u200cهای منحصر به فرد فهرست بها')),
                ('progress_percentage', models.DecimalField(decimal_places=2, default=0, help_text='بر اساس نسبت مبلغ متره به مبلغ قرارداد', max_digits=5, verbose_name='درصد پیشرفت')),
                ('vat_rate', models.DecimalField(decimal_places=2, default=9.0, max_digits=5, verbose_name='نرخ مالیات')),
                ('last_updated', models.DateTimeField(auto_now=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('project', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='financial_summary', to='project.project', verbose_name='پروژه مرتبط')),
            ],
            options={
                'verbose_name': 'خلاصه مالی پروژه',
                'verbose_name_plural': 'خلاصه\u200cهای مالی پروژه\u200cها',
                'ordering': ['-last_updated'],
            },
        ),
        migrations.CreateModel(
            name='MeasurementSessionItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('row_description', models.CharField(help_text="توضیح خاص این متره (مثل 'دیوار غربی - طبقه ۱')", max_length=255, verbose_name='شرح ردیف')),
                ('length', models.DecimalField(blank=True, decimal_places=2, help_text='طول در متر', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='طول (متر)')),
                ('width', models.DecimalField(blank=True, decimal_places=2, help_text='عرض در متر', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='عرض (متر)')),
                ('height', models.DecimalField(blank=True, decimal_places=2, help_text='ارتفاع در متر', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='ارتفاع (متر)')),
                ('weight', models.DecimalField(blank=True, decimal_places=2, help_text='وزن کل در کیلوگرم', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0'))], verbose_name='وزن (کیلوگرم)')),
                ('count', models.DecimalField(decimal_places=2, default=1, help_text='تعداد تکرار', max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='تعداد')),
                ('quantity', models.DecimalField(decimal_places=2, default=0, help_text='مقدار محاسبه\u200cشده بر اساس واحد', max_digits=15, verbose_name='مقدار کل')),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, help_text='قیمت واحد از فهرست بها', max_digits=12, verbose_name='قیمت واحد')),
                ('item_total', models.DecimalField(decimal_places=2, default=0, help_text='مقدار × قیمت واحد', max_digits=15, verbose_name='مبلغ کل ردیف')),
                ('notes', models.TextField(blank=True, help_text='یادداشت\u200cهای خاص این ردیف', null=True, verbose_name='یادداشت ردیف')),
                ('is_active', models.BooleanField(default=True, verbose_name='فعال/غیرفعال')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='زمان ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='زمان آخرین ویرایش')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_items', to=settings.AUTH_USER_MODEL, verbose_name='ایجادکننده')),
                ('measurement_session_number', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='sooratvaziat.measurementsession', verbose_name='صورت\u200cجلسه')),
                ('modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modified_items', to=settings.AUTH_USER_MODEL, verbose_name='ویرایش\u200cکننده')),
                ('pricelist_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='session_items', to='fehrestbaha.pricelistitem', verbose_name='آیتم فهرست بها')),
            ],
            options={
                'verbose_name': 'آیتم صورت\u200cجلسه',
                'verbose_name_plural': 'آیتم\u200cهای صورت\u200cجلسه',
                'ordering': ['pricelist_item__row_number', 'row_description'],
                'unique_together': {('measurement_session_number', 'pricelist_item', 'row_description')},
            },
        ),
    ]
