<!-- templates/projects/project_create.html -->
{% extends 'layout/project_base.html' %}
{% load static %}

{% block title %}Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯{% endblock %}

{% block content %}
<div class="container-fluid">
    
    <!-- Messages -->
    {% if messages %}
    <div class="row mb-4">
        <div class="col-12">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                <i class="bi {% if message.tags == 'success' %}bi-check-circle text-success{% elif message.tags == 'error' %}bi-exclamation-triangle text-danger{% elif message.tags == 'warning' %}bi-exclamation-triangle text-warning{% else %}bi-info-circle text-info{% endif %} me-2"></i>
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <nav aria-label="breadcrumb" class="d-none d-md-block">
                <ol class="breadcrumb breadcrumb-light">
                    <li class="breadcrumb-item">
                        <a href="{% url 'projects:project_list' %}">
                            <i class="bi bi-buildings me-1"></i>Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§
                        </a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯</li>
                </ol>
            </nav>
            <h2 class="mb-1">
                <i class="bi bi-plus-circle text-primary me-2"></i>
                Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯
            </h2>
            <p class="text-muted mb-0">
                <small>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</small>
            </p>
        </div>
        
        <div class="d-flex gap-2">
            <a href="{% url 'projects:project_list' %}" 
               class="btn btn-outline-secondary">
                <i class="bi bi-arrow-right me-2"></i>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§
            </a>
        </div>
    </div>

    <!-- ÙØ±Ù… Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡ -->
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card border-0 shadow-lg">
                <div class="card-header bg-primary border-0">
                    <h5 class="card-title mb-0 text-white">
                        <i class="bi bi-plus-circle text-white me-2"></i>
                        Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯
                    </h5>
                </div>
                
                <div class="card-body p-4">
                    <form method="POST" id="projectCreateForm" enctype="multipart/form-data" novalidate>
                        {% csrf_token %}
                        
                        <!-- Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ú©Ù„ÛŒ -->
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                <i class="bi bi-exclamation-triangle me-2"></i>
                                {{ form.non_field_errors }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        {% endif %}
                        
                        <div class="row g-4">
                            <!-- Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„: Ù†Ø§Ù… Ùˆ Ú©Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ -->
                            <div class="col-md-8">
                                <div class="form-floating">
                                    {{ form.project_name }}
                                    <label for="{{ form.project_name.id_for_label }}">
                                        {{ form.project_name.label }} <span class="text-danger">*</span>
                                    </label>
                                    {% if form.project_name.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.project_name.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="form-text">Ù†Ø§Ù… Ú©Ø§Ù…Ù„ Ù¾Ø±ÙˆÚ˜Ù‡</div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="form-floating">
                                    {{ form.project_code }}
                                    <label for="{{ form.project_code.id_for_label }}">
                                        {{ form.project_code.label }} <span class="text-danger">*</span>
                                    </label>
                                    {% if form.project_code.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.project_code.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="form-text">Ù…Ø«Ø§Ù„: P-1403-001</div>
                            </div>
                            
                            <!-- Ø±Ø¯ÛŒÙ Ø¯ÙˆÙ…: Ø³Ø§Ù„ Ø§Ø¬Ø±Ø§ Ùˆ ØªØ§Ø±ÛŒØ® Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ -->
                            <div class="col-md-6">
                                <label for="{{ form.execution_year.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.execution_year.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.execution_year }}
                                {% if form.execution_year.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.execution_year.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Ø³Ø§Ù„ Ø§Ø¬Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ØµÙˆØ±Øª ÙˆØ¶Ø¹ÛŒØª</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="{{ form.contract_date.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.contract_date.label }} <span class="text-danger">*</span>
                                </label>
                                <div class="input-group">
                                    {{ form.contract_date }}
                                    <span class="input-group-text bg-primary text-white cursor-pointer" id="calendarTrigger">
                                        <i class="bi bi-calendar3"></i>
                                    </span>
                                </div>
                                {% if form.contract_date.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.contract_date.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">ÙØ±Ù…Øª: 1403/06/15</div>
                            </div>
                            
                            <!-- Ø±Ø¯ÛŒÙ Ø³ÙˆÙ…: Ù†ÙˆØ¹ Ù¾Ø±ÙˆÚ˜Ù‡ Ùˆ Ù…Ø¨Ù„Øº -->
                            <div class="col-md-6">
                                <label for="{{ form.project_type.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.project_type.label }}
                                </label>
                                {{ form.project_type }}
                                {% if form.project_type.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.project_type.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Ù†ÙˆØ¹ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="{{ form.contract_amount.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.contract_amount.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.contract_amount }}
                                {% if form.contract_amount.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.contract_amount.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Ø¨Ù‡ Ø±ÛŒØ§Ù„ - Ù…Ø«Ø§Ù„: 1,500,000,000</div>
                            </div>
                            
                            <!-- Ø±Ø¯ÛŒÙ Ú†Ù‡Ø§Ø±Ù…: Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ -->
                            <div class="col-md-4">
                                <label for="{{ form.country.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.country.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.country }}
                                {% if form.country.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.country.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Ú©Ø´ÙˆØ± Ù…Ø­Ù„ Ù¾Ø±ÙˆÚ˜Ù‡</div>
                            </div>

                            <div class="col-md-4">
                                <label for="{{ form.province.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.province.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.province }}
                                {% if form.province.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.province.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Ø§Ø³ØªØ§Ù† Ù…Ø­Ù„ Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡</div>
                            </div>

                            <div class="col-md-4">
                                <label for="{{ form.city.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.city.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.city }}
                                {% if form.city.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.city.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Ø´Ù‡Ø± Ù…Ø­Ù„ Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡</div>
                            </div>
                            
                            <!-- Ø±Ø¯ÛŒÙ Ù¾Ù†Ø¬Ù…: Ø´Ù…Ø§Ø±Ù‡ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ùˆ ÙˆØ¶Ø¹ÛŒØª -->
                            <div class="col-md-6">
                                <div class="form-floating">
                                    {{ form.contract_number }}
                                    <label for="{{ form.contract_number.id_for_label }}">
                                        {{ form.contract_number.label }} <span class="text-danger">*</span>
                                    </label>
                                    {% if form.contract_number.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.contract_number.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="form-text">Ù…Ø«Ø§Ù„: 1403/001</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="{{ form.status.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.status.label }}
                                </label>
                                {{ form.status }}
                                {% if form.status.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.status.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡</div>
                            </div>
                            
                            <!-- Ø±Ø¯ÛŒÙ Ø´Ø´Ù…: ÙØ§ÛŒÙ„ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ -->
                            <div class="col-12">
                                <label for="{{ form.contract_file.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.contract_file.label }}
                                </label>
                                {{ form.contract_file }}
                                {% if form.contract_file.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.contract_file.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">
                                    ÙØ§ÛŒÙ„ PDF ÛŒØ§ Word (Ø­Ø¯Ø§Ú©Ø«Ø± 5 Ù…Ú¯Ø§Ø¨Ø§ÛŒØª) - Ø§Ø®ØªÛŒØ§Ø±ÛŒ
                                </div>
                            </div>
                            
                            <!-- Ø±Ø¯ÛŒÙ Ù‡ÙØªÙ…: ØªÙˆØ¶ÛŒØ­Ø§Øª -->
                            <div class="col-12">
                                <label for="{{ form.description.id_for_label }}" class="form-label fw-semibold">
                                    {{ form.description.label }}
                                </label>
                                {{ form.description }}
                                {% if form.description.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.description.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø®ØªØµØ± Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</div>
                            </div>

                            <!-- Ø±Ø¯ÛŒÙ Ù‡Ø´ØªÙ…: Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù¾Ø±ÙˆÚ˜Ù‡ -->
                            <div class="col-12">
                                <div class="card border-0 bg-light">
                                    <div class="card-header bg-secondary text-white">
                                        <h6 class="card-title mb-0">
                                            <i class="bi bi-people-fill me-2"></i>
                                            Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù¾Ø±ÙˆÚ˜Ù‡
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <label for="{{ form.employer_user.id_for_label }}" class="form-label fw-semibold">
                                                    {{ form.employer_user.label }}
                                                </label>
                                                {{ form.employer_user }}
                                                {% if form.employer_user.errors %}
                                                    <div class="invalid-feedback d-block">
                                                        {{ form.employer_user.errors.0 }}
                                                    </div>
                                                {% endif %}
                                                <div class="form-text">Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù†Ù‚Ø´ Ú©Ø§Ø±ÙØ±Ù…Ø§</div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label for="{{ form.project_manager_user.id_for_label }}" class="form-label fw-semibold">
                                                    {{ form.project_manager_user.label }}
                                                </label>
                                                {{ form.project_manager_user }}
                                                {% if form.project_manager_user.errors %}
                                                    <div class="invalid-feedback d-block">
                                                        {{ form.project_manager_user.errors.0 }}
                                                    </div>
                                                {% endif %}
                                                <div class="form-text">Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù†Ù‚Ø´ Ù…Ø¯ÛŒØ± Ø·Ø±Ø­</div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label for="{{ form.consultant_user.id_for_label }}" class="form-label fw-semibold">
                                                    {{ form.consultant_user.label }}
                                                </label>
                                                {{ form.consultant_user }}
                                                {% if form.consultant_user.errors %}
                                                    <div class="invalid-feedback d-block">
                                                        {{ form.consultant_user.errors.0 }}
                                                    </div>
                                                {% endif %}
                                                <div class="form-text">Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù†Ù‚Ø´ Ù…Ø´Ø§ÙˆØ±</div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label for="{{ form.supervising_engineer_user.id_for_label }}" class="form-label fw-semibold">
                                                    {{ form.supervising_engineer_user.label }}
                                                </label>
                                                {{ form.supervising_engineer_user }}
                                                {% if form.supervising_engineer_user.errors %}
                                                    <div class="invalid-feedback d-block">
                                                        {{ form.supervising_engineer_user.errors.0 }}
                                                    </div>
                                                {% endif %}
                                                <div class="form-text">Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù†Ù‚Ø´ Ù†Ø§Ø¸Ø±</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ -->
                        <div class="d-flex justify-content-between align-items-center mt-5 pt-3 border-top">
                            <div>
                                <small class="text-muted">
                                    ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¨Ø§ Ø¹Ù„Ø§Ù…Øª * Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ù‡Ø³ØªÙ†Ø¯
                                </small>
                            </div>
                            
                            <div class="d-flex gap-2">
                                <a href="{% url 'projects:project_list' %}" class="btn btn-outline-secondary">
                                    <i class="bi bi-arrow-right me-2"></i>Ø§Ù†ØµØ±Ø§Ù
                                </a>
                                <button type="submit" class="btn btn-success px-4" id="submitBtn">
                                    <i class="bi bi-plus-circle me-2"></i>
                                    Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡
                                    <span class="spinner-border spinner-border-sm ms-2 d-none" id="submitSpinner"></span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="application/json" id="province-cities-data">
    {{ province_cities_json|safe }}
</script>
{% endblock %}

{% block extra_css %}
<style>
.form-control, .form-select {
    border-radius: 8px;
    border: 1.5px solid #dee2e6;
    padding: 0.75rem 1rem;
}

.form-control:focus, .form-select:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.2rem rgba(13,110,253,0.15);
}

.input-group-text {
    cursor: pointer;
}

.is-invalid {
    border-color: #dc3545 !important;
}

.invalid-feedback {
    color: #dc3545;
    font-size: 0.875rem;
}
</style>
{% endblock %}

{% block extra_js %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸš€ Starting form initialization...');
    
    // Persian Datepicker
    function initializeDatepicker() {
        const dateInput = document.querySelector('input[name="contract_date"]');
        if (!dateInput) {
            console.log('âŒ Date input not found');
            return;
        }
        
        // Check if persianDate is available
        if (typeof persianDate === 'undefined') {
            console.error('âŒ persianDate library not loaded');
            return;
        }
        
        console.log('âœ… PersianDate library loaded:', typeof persianDate);
        
        // Set today's date as default
        const today = new persianDate();
        const todayFormatted = today.format('YYYY/MM/DD');
        
        // If field is empty, set today's date
        if (!dateInput.value.trim()) {
            dateInput.value = todayFormatted;
        }
        
        // Initialize Persian Datepicker
        $(dateInput).persianDatepicker({
            format: 'YYYY/MM/DD',
            initialValue: true,
            initialValueType: 'persian',
            autoClose: true,
            position: "auto",
            observer: true,
            calendar: {
                persian: {
                    locale: 'fa',
                    showHint: true,
                }
            },
            onSelect: function(unixDate) {
                const selectedDate = new persianDate(unixDate);
                const formattedDate = selectedDate.format('YYYY/MM/DD');
                console.log('ğŸ“… Selected date:', formattedDate);
                dateInput.value = formattedDate;
                dateInput.classList.remove('is-invalid');
            }
        });
        
        // Trigger calendar from icon
        const calendarTrigger = document.getElementById('calendarTrigger');
        if (calendarTrigger) {
            calendarTrigger.addEventListener('click', function() {
                $(dateInput).persianDatepicker('show');
            });
        }
        
        console.log('âœ… Persian Datepicker initialized');
    }
        
    // Province and City Handling
    function initializeLocationFields() {
        const provinceSelect = document.getElementById('id_province');
        const citySelect = document.getElementById('id_city');
        const countrySelect = document.getElementById('id_country');
        
        if (!provinceSelect || !citySelect || !countrySelect) return;
        
        const citiesDataElement = document.getElementById('province-cities-data');
        let citiesByProvince = {};
        
        if (citiesDataElement) {
            try {
                citiesByProvince = JSON.parse(citiesDataElement.textContent);
            } catch (e) {
                console.error('Error parsing cities data:', e);
                return;
            }
        }
        
        function updateCities() {
            const selectedProvince = provinceSelect.value;
            citySelect.innerHTML = '<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù‡Ø±</option>';
            citySelect.disabled = true;
            
            if (selectedProvince && citiesByProvince[selectedProvince]) {
                const cities = citiesByProvince[selectedProvince];
                cities.forEach(function(city) {
                    const option = document.createElement('option');
                    option.value = city[0];  // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù‚Ø¯Ø§Ø± Ø§ÙˆÙ„ (Ù…Ù‚Ø¯Ø§Ø± Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡)
                    option.textContent = city[1];  // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù‚Ø¯Ø§Ø± Ø¯ÙˆÙ… (Ù†Ù…Ø§ÛŒØ´ÛŒ)
                    citySelect.appendChild(option);
                });
                citySelect.disabled = false;
            }
        }
        
        provinceSelect.addEventListener('change', function() {
            this.classList.remove('is-invalid');
            updateCities();
        });
        
        citySelect.addEventListener('change', function() {
            this.classList.remove('is-invalid');
        });
        
        // Initialize cities if province is already selected
        if (provinceSelect.value) {
            updateCities();
        }
    }

    // Form Validation
    function initializeFormValidation() {
        const form = document.getElementById('projectCreateForm');
        if (!form) return;
        
        form.addEventListener('submit', function(e) {
            console.log('ğŸ“¤ Form submission started...');
            
            let isValid = true;
            
            // Validate required fields
            const requiredFields = form.querySelectorAll('[required]');
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('is-invalid');
                    isValid = false;
                }
            });
            
            // Validate province and city
            const provinceSelect = document.getElementById('id_province');
            const citySelect = document.getElementById('id_city');
            
            if (!provinceSelect.value) {
                provinceSelect.classList.add('is-invalid');
                isValid = false;
            }
            
            if (!citySelect.disabled && !citySelect.value) {
                citySelect.classList.add('is-invalid');
                isValid = false;
            }
            
            if (!isValid) {
                e.preventDefault();
                // Scroll to first error
                const firstError = form.querySelector('.is-invalid');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    firstError.focus();
                }
            } else {
                // Show loading spinner
                const submitBtn = document.getElementById('submitBtn');
                const submitSpinner = document.getElementById('submitSpinner');
                if (submitBtn && submitSpinner) {
                    submitBtn.disabled = true;
                    submitSpinner.classList.remove('d-none');
                    submitBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Ø¯Ø± Ø­Ø§Ù„ Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡...';
                }
            }
        });
    }

    // Initialize everything
    initializeDatepicker();
    initializeLocationFields();
    initializeFormValidation();
    console.log('ğŸ‰ Form initialization completed!');
});
</script>
{% endblock %}